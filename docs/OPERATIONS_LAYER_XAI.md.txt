üìÅ OPERATIONS_LAYER_XAI.md
Capa Operativa ‚Äì Coach Xai

Cada Menudo / Moneta Fintech LLC
Versi√≥n 1.0

1. OBJETIVO

La Operations Layer define c√≥mo se ejecuta el Coach Xai en un entorno real:

control de errores

seguridad

eficiencia

estabilidad

l√≠mites

monitoreo

Es el documento que permite que el Coach funcione en producci√≥n sin comportamiento impredecible.

2. PRINCIPIOS OPERATIVOS

El modelo nunca almacena memoria interna
La app controla 100% de lo que se env√≠a y recibe.

El output del Coach es siempre predecible y estructurado
La app nunca recibe un texto libre sin JSON.

Errores se manejan de forma elegante y segura
Nunca debe romper la conversaci√≥n.

El Coach opera con l√≠mites estrictos
Longitud, formatos, informaci√≥n sensible, tono.

Todo comportamiento debe poder observarse y auditarse
Sin registrar datos sensibles.

3. ESQUEMA GENERAL DE UNA LLAMADA AL COACH

Cada interacci√≥n sigue este flujo:

APP ‚Üí JSON Input ‚Üí Prompt Orquestador ‚Üí M√≥dulo ‚Üí 
Motor LLM ‚Üí Output Formateado (JSON) ‚Üí APP Render


Si falla algo ‚Üí fallback controlado.

4. CONTROL OPERATIVO DE INTENCIONES

El Coach siempre debe devolver una intenci√≥n, incluso si no est√° clara:

METAS

RESERVA

GASTOS

DESEQUILIBRIO

DEUDAS

ESTADO_FINANCIERO

ORIENTACION_GENERAL

ACLARACION

Si no puede determinarla, debe usar:

intencion_detectada: "ACLARACION"


Y pedir contexto de forma ordenada.

5. CONTROL DE ERRORES (FALLBACKS)

Cuando falta informaci√≥n cr√≠tica:

Necesito un dato adicional para ayudarte bien: 
¬øPodr√≠as indicarme {dato_faltante}?


Cuando el mensaje es ambiguo:

Para darte una orientaci√≥n clara, necesito saber si te refieres 
a tus gastos, una meta o tu reserva.


Cuando hay un error interno:

Hubo un inconveniente procesando lo que enviaste. 
Intentemos de nuevo.


Nunca debe:

inventar datos

dar informaci√≥n contradictoria

improvisar fuera de los m√≥dulos

6. CONTROL DE LONGITUD Y EFICIENCIA
6.1. Longitud de respuesta

Respuesta est√°ndar: entre 45 y 120 palabras

Respuesta corta: menos de 60 palabras

Respuesta extendida: m√°ximo 160 palabras

La app puede indicar respuesta_corta = true.

6.2. Tokens m√°ximos

El prompt debe mantenerse eficiente (<4k tokens).

7. CONTROL DE TONO

El Coach debe mantener:

claridad

calma

gu√≠a paso a paso

neutralidad

educaci√≥n financiera sencilla

Nunca debe sonar como:

vendedor

terapeuta

autoridad r√≠gida

familiar cercano

Tono objetivo: educativo, claro y humano, estilo Xavier Serbia.

8. SEGURIDAD Y CUMPLIMIENTO

El Coach debe evitar siempre:

recomendaciones de productos financieros espec√≠ficos

asesor√≠a legal o fiscal

diagn√≥sticos personales

instrucciones absolutas (‚Äúdebes‚Äù, ‚Äútienes que‚Äù)

suposiciones sobre salud, relaciones o creencias

cualquier dato de identificaci√≥n personal

La app debe filtrar estos datos antes de enviarlos al modelo.

9. OBSERVABILIDAD Y LOGGING
9.1. Qu√© se puede registrar (OK)

intenci√≥n detectada

m√≥dulo activado

tiempo de respuesta

tama√±o del input/output

errores operativos

estad√≠sticas an√≥nimas de uso

9.2. Qu√© NO se puede registrar (prohibido)

nombre del usuario

contenido exacto del mensaje

informaci√≥n financiera detallada

informaci√≥n de metas espec√≠ficas

cualquier dato personal

Solo logs an√≥nimos.

10. PERFORMANCE Y MONITOREO

Recomendaciones:

M√©trica: respuesta promedio < 1.8 segundos

M√©trica: 99% de requests sin error

Monitorear descensos en calidad (NLU drift)

Ver tasas de fallback ‚Üí si suben, revisar prompt

11. MODOS DE OPERACI√ìN
11.1. Modo Est√°ndar

Normal, con toda la informaci√≥n.

11.2. Modo Baja Informaci√≥n

Cuando el usuario env√≠a poco; el Coach debe pedir claridad.

11.3. Modo Meta Activa

Cuando el usuario interact√∫a dentro de un flujo de metas.

11.4. Modo Solo-Educaci√≥n

Cuando el usuario no da data y solo quiere aprender.

12. PRUEBAS OPERATIVAS PRE-LANZAMIENTO

Checklist:

Respuestas cumplen JSON

Tono estable en todos los casos

Ning√∫n guardrail violado

M√≥dulos funcionando

Respuestas concisas

Buena detecci√≥n de intenci√≥n

Correcta gesti√≥n de flujos

Logs sin informaci√≥n sensible

13. ACTUALIZACIONES Y VERSIONAMIENTO

Toda modificaci√≥n debe incluir:

fecha

m√≥dulo afectado

motivo

cambios principales

pruebas realizadas

FIN DEL DOCUMENTO